(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[189],{9909:function(e,t,r){Promise.resolve().then(r.bind(r,2126))},2126:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return DiagnosisPage}});var s=r(7437),a=r(2265),n=r(1396),o=r.n(n),i=r(8681);let c=[{id:1,question:"どのような味がお好みですか？",options:[{value:"sweet",label:"甘い",weight:{sake:2,wine:3,beer:1,shochu:1}},{value:"dry",label:"辛口",weight:{sake:3,wine:2,beer:2,shochu:3}},{value:"bitter",label:"苦い",weight:{sake:1,wine:1,beer:3,shochu:1}},{value:"sour",label:"酸っぱい",weight:{sake:1,wine:3,beer:1,shochu:1}}]},{id:2,question:"アルコール度数の好みは？",options:[{value:"low",label:"低め（5-10%）",weight:{sake:1,wine:2,beer:3,shochu:0}},{value:"medium",label:"中程度（10-20%）",weight:{sake:3,wine:3,beer:1,shochu:1}},{value:"high",label:"高め（20%以上）",weight:{sake:2,wine:1,beer:0,shochu:3}}]},{id:3,question:"どのようなシーンで飲みますか？",options:[{value:"daily",label:"日常的に",weight:{sake:2,wine:2,beer:3,shochu:2}},{value:"special",label:"特別な日に",weight:{sake:3,wine:3,beer:1,shochu:2}},{value:"party",label:"パーティーで",weight:{sake:1,wine:2,beer:3,shochu:1}},{value:"alone",label:"一人でゆっくり",weight:{sake:3,wine:2,beer:2,shochu:3}}]},{id:4,question:"温度の好みは？",options:[{value:"cold",label:"冷たい",weight:{sake:2,wine:2,beer:3,shochu:2}},{value:"room",label:"常温",weight:{sake:2,wine:3,beer:1,shochu:2}},{value:"warm",label:"温かい",weight:{sake:3,wine:1,beer:0,shochu:3}}]}];function DiagnosisPage(){let[e,t]=(0,a.useState)(0),[r,n]=(0,a.useState)([]),[l,d]=(0,a.useState)(null),[u,h]=(0,a.useState)(!1),[m,b]=(0,a.useState)([]),[x,g]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let initializeData=async()=>{await (0,i.KJ)()};initializeData()},[]);let handleAnswer=s=>{let a=[...r,s];n(a),e<c.length-1?t(e+1):calculateResult(a)},calculateResult=async e=>{g(!0);try{let t={sake:0,wine:0,beer:0,shochu:0};e.forEach((e,r)=>{let s=c[r],a=s.options.find(t=>t.value===e);a&&Object.entries(a.weight).forEach(e=>{let[r,s]=e;t[r]+=s})});let r=Object.entries(t).reduce((e,r)=>t[e[0]]>t[r[0]]?e:r)[0],s=await i.K0.getAll(),a=s.filter(e=>e.category===r);await i.HI.save({answers:e,result:r,timestamp:Date.now()}),d(r),b(a.slice(0,3)),h(!0)}catch(e){console.error("診断結果の計算に失敗しました:",e)}finally{g(!1)}};return(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,s.jsx)("header",{className:"bg-white shadow-sm rounded-lg mb-8",children:(0,s.jsxs)("div",{className:"flex items-center justify-between p-6",children:[(0,s.jsx)(o(),{href:"/",className:"text-3xl font-bold text-primary-600",children:"\uD83C\uDF76 酒屋"}),(0,s.jsxs)("nav",{className:"flex space-x-6",children:[(0,s.jsx)(o(),{href:"/",className:"text-secondary-600 hover:text-primary-600 transition-colors",children:"ホーム"}),(0,s.jsx)(o(),{href:"/products",className:"text-secondary-600 hover:text-primary-600 transition-colors",children:"商品一覧"}),(0,s.jsx)(o(),{href:"/random",className:"text-secondary-600 hover:text-primary-600 transition-colors",children:"ランダム提案"}),(0,s.jsx)(o(),{href:"/cart",className:"text-secondary-600 hover:text-primary-600 transition-colors",children:"カート"})]})]})}),(0,s.jsx)("div",{className:"max-w-2xl mx-auto",children:u?(0,s.jsxs)("div",{className:"card",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("div",{className:"text-6xl mb-4",children:"\uD83C\uDF89"}),(0,s.jsx)("h1",{className:"text-3xl font-bold text-secondary-700 mb-2",children:"診断結果"}),(0,s.jsx)("p",{className:"text-lg text-secondary-600",children:"あなたにおすすめのお酒は..."})]}),(0,s.jsxs)("div",{className:"bg-primary-50 rounded-lg p-6 mb-8 text-center",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-primary-700 mb-2",children:{sake:"日本酒",wine:"ワイン",beer:"ビール",shochu:"焼酎"}[l]||l}),(0,s.jsxs)("p",{className:"text-secondary-600",children:["sake"===l&&"あなたは繊細で上品な味わいを好む方ですね。日本酒の奥深い世界をお楽しみください。","wine"===l&&"あなたはフルーティーで豊かな香りを好む方ですね。ワインの多様性をお楽しみください。","beer"===l&&"あなたは爽快で飲みやすいお酒を好む方ですね。ビールの爽やかさをお楽しみください。","shochu"===l&&"あなたは力強くて個性的な味わいを好む方ですね。焼酎の深い味わいをお楽しみください。"]})]}),m.length>0&&(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-secondary-700 mb-4",children:"おすすめ商品"}),(0,s.jsx)("div",{className:"grid gap-4",children:m.map(e=>(0,s.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[(0,s.jsx)("h4",{className:"font-semibold text-secondary-700 mb-2",children:e.name}),(0,s.jsx)("p",{className:"text-secondary-600 text-sm mb-2",children:e.description}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("span",{className:"text-primary-600 font-bold",children:["\xa5",e.price.toLocaleString()]}),(0,s.jsx)("button",{className:"btn-primary",children:"カートに追加"})]})]},e.id))})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,s.jsx)("button",{onClick:()=>{t(0),n([]),d(null),h(!1)},className:"btn-secondary flex-1",children:"もう一度診断する"}),(0,s.jsx)(o(),{href:"/products",className:"btn-primary flex-1 text-center",children:"商品一覧を見る"})]})]}):(0,s.jsxs)("div",{className:"card",children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-secondary-700 mb-2",children:"\uD83C\uDFAF お酒診断"}),(0,s.jsx)("p",{className:"text-secondary-600",children:"いくつかの質問にお答えいただくと、あなたにぴったりのお酒をおすすめします！"})]}),(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm text-secondary-600 mb-2",children:[(0,s.jsxs)("span",{children:["質問 ",e+1," / ",c.length]}),(0,s.jsxs)("span",{children:[Math.round((e+1)/c.length*100),"%"]})]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-primary-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat((e+1)/c.length*100,"%")}})})]}),(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-secondary-700 mb-6",children:c[e].question}),(0,s.jsx)("div",{className:"space-y-3",children:c[e].options.map(e=>(0,s.jsx)("button",{onClick:()=>handleAnswer(e.value),disabled:x,className:"w-full text-left p-4 border border-gray-200 rounded-lg hover:border-primary-300 hover:bg-primary-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e.label},e.value))})]}),e>0&&(0,s.jsx)("button",{onClick:()=>{t(e-1),n(r.slice(0,-1))},className:"btn-secondary",children:"前の質問に戻る"})]})})]})}},8681:function(e,t,r){"use strict";r.d(t,{HI:function(){return o},K0:function(){return s},KJ:function(){return seedInitialData},P4:function(){return a},_9:function(){return n}});let initDB=()=>new Promise((e,t)=>{let r=indexedDB.open("SakeShopDB",1);r.onerror=()=>t(r.error),r.onsuccess=()=>e(r.result),r.onupgradeneeded=e=>{let t=e.target.result;if(!t.objectStoreNames.contains("products")){let e=t.createObjectStore("products",{keyPath:"id"});e.createIndex("category","category",{unique:!1}),e.createIndex("name","name",{unique:!1})}if(t.objectStoreNames.contains("cart")||t.createObjectStore("cart",{keyPath:"id"}),!t.objectStoreNames.contains("orders")){let e=t.createObjectStore("orders",{keyPath:"id"});e.createIndex("status","status",{unique:!1}),e.createIndex("date","date",{unique:!1})}if(!t.objectStoreNames.contains("users")){let e=t.createObjectStore("users",{keyPath:"id"});e.createIndex("email","email",{unique:!0})}t.objectStoreNames.contains("diagnosis_history")||t.createObjectStore("diagnosis_history",{keyPath:"id",autoIncrement:!0}),t.objectStoreNames.contains("random_history")||t.createObjectStore("random_history",{keyPath:"id",autoIncrement:!0})}}),s={getAll:async()=>{let e=await initDB();return new Promise((t,r)=>{let s=e.transaction(["products"],"readonly"),a=s.objectStore("products"),n=a.getAll();n.onsuccess=()=>t(n.result),n.onerror=()=>r(n.error)})},add:async e=>{let t=await initDB();return new Promise((r,s)=>{let a=t.transaction(["products"],"readwrite"),n=a.objectStore("products"),o=n.add(e);o.onsuccess=()=>r(),o.onerror=()=>s(o.error)})},update:async e=>{let t=await initDB();return new Promise((r,s)=>{let a=t.transaction(["products"],"readwrite"),n=a.objectStore("products"),o=n.put(e);o.onsuccess=()=>r(),o.onerror=()=>s(o.error)})},delete:async e=>{let t=await initDB();return new Promise((r,s)=>{let a=t.transaction(["products"],"readwrite"),n=a.objectStore("products"),o=n.delete(e);o.onsuccess=()=>r(),o.onerror=()=>s(o.error)})},getByCategory:async e=>{let t=await initDB();return new Promise((r,s)=>{let a=t.transaction(["products"],"readonly"),n=a.objectStore("products"),o=n.index("category"),i=o.getAll(e);i.onsuccess=()=>r(i.result),i.onerror=()=>s(i.error)})}},a={getAll:async()=>{let e=await initDB();return new Promise((t,r)=>{let s=e.transaction(["cart"],"readonly"),a=s.objectStore("cart"),n=a.getAll();n.onsuccess=()=>t(n.result),n.onerror=()=>r(n.error)})},add:async e=>{let t=await initDB();return new Promise((r,s)=>{let a=t.transaction(["cart"],"readwrite"),n=a.objectStore("cart"),o=n.put(e);o.onsuccess=()=>r(),o.onerror=()=>s(o.error)})},remove:async e=>{let t=await initDB();return new Promise((r,s)=>{let a=t.transaction(["cart"],"readwrite"),n=a.objectStore("cart"),o=n.delete(e);o.onsuccess=()=>r(),o.onerror=()=>s(o.error)})},clear:async()=>{let e=await initDB();return new Promise((t,r)=>{let s=e.transaction(["cart"],"readwrite"),a=s.objectStore("cart"),n=a.clear();n.onsuccess=()=>t(),n.onerror=()=>r(n.error)})}},n={getAll:async()=>{let e=await initDB();return new Promise((t,r)=>{let s=e.transaction(["orders"],"readonly"),a=s.objectStore("orders"),n=a.getAll();n.onsuccess=()=>t(n.result),n.onerror=()=>r(n.error)})},add:async e=>{let t=await initDB();return new Promise((r,s)=>{let a=t.transaction(["orders"],"readwrite"),n=a.objectStore("orders"),o=n.add(e);o.onsuccess=()=>r(),o.onerror=()=>s(o.error)})},updateStatus:async(e,t)=>{let r=await initDB();return new Promise((s,a)=>{let n=r.transaction(["orders"],"readwrite"),o=n.objectStore("orders"),i=o.get(e);i.onsuccess=()=>{let e=i.result;if(e){e.status=t;let r=o.put(e);r.onsuccess=()=>s(),r.onerror=()=>a(r.error)}else a(Error("Order not found"))},i.onerror=()=>a(i.error)})}},o={save:async e=>{let t=await initDB();return new Promise((r,s)=>{let a=t.transaction(["diagnosis_history"],"readwrite"),n=a.objectStore("diagnosis_history"),o=n.add(e);o.onsuccess=()=>r(),o.onerror=()=>s(o.error)})},getHistory:async()=>{let e=await initDB();return new Promise((t,r)=>{let s=e.transaction(["diagnosis_history"],"readonly"),a=s.objectStore("diagnosis_history"),n=a.getAll();n.onsuccess=()=>t(n.result),n.onerror=()=>r(n.error)})}},seedInitialData=async()=>{let e=await s.getAll();if(0===e.length)for(let e of[{id:1,name:"純米大吟醸 山田錦",category:"sake",price:3500,description:"山田錦を使用した上品な味わいの純米大吟醸酒",alcoholPercent:15.5,image:"/images/sake1.jpg",tags:["日本酒","純米大吟醸","山田錦"],stock:10,pairing:["刺身","天ぷら","和食"]},{id:2,name:"本格焼酎 黒霧島",category:"shochu",price:1200,description:"さつまいもの甘みが感じられる本格焼酎",alcoholPercent:25,image:"/images/shochu1.jpg",tags:["焼酎","さつまいも","本格"],stock:15,pairing:["焼き鳥","餃子","鍋料理"]},{id:3,name:"シャルドネ 白ワイン",category:"wine",price:2800,description:"フルーティーで爽やかな白ワイン",alcoholPercent:12,image:"/images/wine1.jpg",tags:["ワイン","白ワイン","シャルドネ"],stock:8,pairing:["魚料理","チーズ","サラダ"]},{id:4,name:"クラフトビール IPA",category:"beer",price:450,description:"ホップの苦味が効いたクラフトビール",alcoholPercent:6.5,image:"/images/beer1.jpg",tags:["ビール","クラフト","IPA"],stock:20,pairing:["ピザ","ハンバーガー","スパイシー料理"]},{id:5,name:"チーズ盛り合わせ",category:"snack",price:1800,description:"3種類のチーズの盛り合わせ",alcoholPercent:0,image:"/images/cheese1.jpg",tags:["おつまみ","チーズ","盛り合わせ"],stock:12,pairing:["ワイン","日本酒","ビール"]},{id:6,name:"ナッツミックス",category:"snack",price:680,description:"4種類のナッツをミックスした人気のおつまみ",alcoholPercent:0,image:"/images/nuts1.jpg",tags:["おつまみ","ナッツ","ミックス"],stock:25,pairing:["ビール","ウイスキー","焼酎"]}])await s.add(e)}},622:function(e,t,r){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s=r(2265),a=Symbol.for("react.element"),n=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),o=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function q(e,t,r){var s,c={},l=null,d=null;for(s in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(d=t.ref),t)n.call(t,s)&&!i.hasOwnProperty(s)&&(c[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===c[s]&&(c[s]=t[s]);return{$$typeof:a,type:e,key:l,ref:d,props:c,_owner:o.current}}t.jsx=q,t.jsxs=q},7437:function(e,t,r){"use strict";e.exports=r(622)},1396:function(e,t,r){e.exports=r(8326)}},function(e){e.O(0,[326,971,472,744],function(){return e(e.s=9909)}),_N_E=e.O()}]);