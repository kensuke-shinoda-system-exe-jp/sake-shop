(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[427],{6160:function(e,t,r){Promise.resolve().then(r.bind(r,3706))},3706:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return AdminDashboard}});var s=r(7437),a=r(2265),n=r(1396),i=r.n(n),c=r(8681);function AdminDashboard(){let[e,t]=(0,a.useState)(!1),[r,n]=(0,a.useState)({totalProducts:0,totalOrders:0,totalRevenue:0,pendingOrders:0}),[o,l]=(0,a.useState)([]),[d,m]=(0,a.useState)([]),[x,u]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let initializeDashboard=async()=>{let e=localStorage.getItem("isAdminLoggedIn");"true"===e?(t(!0),await loadDashboardData()):window.location.href="/admin"};initializeDashboard()},[]);let loadDashboardData=async()=>{try{await (0,c.KJ)();let e=await c.K0.getAll(),t=await c._9.getAll(),r=t.reduce((e,t)=>e+t.total,0),s=t.filter(e=>"pending"===e.status).length;n({totalProducts:e.length,totalOrders:t.length,totalRevenue:r,pendingOrders:s});let a=t.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime());l(a.slice(0,5));let i=e.filter(e=>e.stock<=5);m(i)}catch(e){console.error("ダッシュボードデータの読み込みに失敗しました:",e)}finally{u(!1)}},updateOrderStatus=async(e,t)=>{try{await c._9.updateStatus(e,t),await loadDashboardData(),alert("注文ステータスを更新しました")}catch(e){console.error("注文ステータスの更新に失敗しました:",e),alert("注文ステータスの更新に失敗しました")}},getStatusBadge=e=>{let t={pending:{label:"処理中",className:"bg-yellow-100 text-yellow-800"},shipped:{label:"発送済み",className:"bg-blue-100 text-blue-800"},delivered:{label:"配送完了",className:"bg-green-100 text-green-800"},cancelled:{label:"キャンセル",className:"bg-red-100 text-red-800"}},r=t[e]||t.pending;return(0,s.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat(r.className),children:r.label})};return!e||x?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-secondary-600",children:e?"データを読み込み中...":"認証を確認中..."})]})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("header",{className:"bg-white shadow-sm",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex justify-between items-center py-6",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(i(),{href:"/",className:"text-2xl font-bold text-primary-600",children:"\uD83C\uDF76 酒屋"}),(0,s.jsx)("span",{className:"ml-4 text-lg font-medium text-secondary-700",children:"管理者ダッシュボード"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)(i(),{href:"/",className:"text-secondary-600 hover:text-primary-600 transition-colors",children:"サイトを見る"}),(0,s.jsx)("button",{onClick:()=>{localStorage.removeItem("isAdminLoggedIn"),window.location.href="/admin"},className:"bg-secondary-100 hover:bg-secondary-200 text-secondary-700 px-4 py-2 rounded-lg transition-colors",children:"ログアウト"})]})]})})}),(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,s.jsx)("nav",{className:"mb-8",children:(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)(i(),{href:"/admin/dashboard",className:"bg-primary-100 text-primary-700 px-4 py-2 rounded-lg font-medium",children:"ダッシュボード"}),(0,s.jsx)(i(),{href:"/admin/products",className:"text-secondary-600 hover:text-primary-600 px-4 py-2 rounded-lg transition-colors",children:"商品管理"}),(0,s.jsx)(i(),{href:"/admin/orders",className:"text-secondary-600 hover:text-primary-600 px-4 py-2 rounded-lg transition-colors",children:"注文管理"})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,s.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"p-2 bg-primary-100 rounded-lg",children:(0,s.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCE6"})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-secondary-600",children:"総商品数"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-secondary-900",children:r.totalProducts})]})]})}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,s.jsx)("span",{className:"text-2xl",children:"\uD83D\uDED2"})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-secondary-600",children:"総注文数"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-secondary-900",children:r.totalOrders})]})]})}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,s.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCB0"})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-secondary-600",children:"総売上"}),(0,s.jsxs)("p",{className:"text-2xl font-bold text-secondary-900",children:["\xa5",r.totalRevenue.toLocaleString()]})]})]})}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"p-2 bg-yellow-100 rounded-lg",children:(0,s.jsx)("span",{className:"text-2xl",children:"⏳"})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-secondary-600",children:"処理待ち注文"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-secondary-900",children:r.pendingOrders})]})]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,s.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,s.jsx)("h3",{className:"text-lg font-medium text-secondary-900",children:"最近の注文"})}),(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("div",{className:"space-y-4",children:o.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("p",{className:"font-medium text-secondary-900",children:e.id}),getStatusBadge(e.status)]}),(0,s.jsx)("p",{className:"text-sm text-secondary-600",children:e.customerName}),(0,s.jsx)("p",{className:"text-sm text-secondary-500",children:e.items.map(e=>e.name).join(", ")}),(0,s.jsx)("p",{className:"text-sm text-secondary-500",children:e.date}),"pending"===e.status&&(0,s.jsxs)("div",{className:"mt-2 space-x-2",children:[(0,s.jsx)("button",{onClick:()=>updateOrderStatus(e.id,"shipped"),className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded",children:"発送済みにする"}),(0,s.jsx)("button",{onClick:()=>updateOrderStatus(e.id,"cancelled"),className:"text-xs bg-red-100 text-red-700 px-2 py-1 rounded",children:"キャンセル"})]})]}),(0,s.jsx)("div",{className:"ml-4 text-right",children:(0,s.jsxs)("p",{className:"font-bold text-primary-600",children:["\xa5",e.total.toLocaleString()]})})]},e.id))}),(0,s.jsx)("div",{className:"mt-4 text-center",children:(0,s.jsx)(i(),{href:"/admin/orders",className:"text-primary-600 hover:text-primary-700 font-medium",children:"すべての注文を見る →"})})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,s.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,s.jsx)("h3",{className:"text-lg font-medium text-secondary-900",children:"在庫不足商品"})}),(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("div",{className:"space-y-4",children:d.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-red-50 rounded-lg border border-red-200",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-secondary-900",children:e.name}),(0,s.jsxs)("p",{className:"text-sm text-secondary-600",children:["在庫: ",e.stock,"個 (要補充レベル: 5個以下)"]})]}),(0,s.jsx)("div",{className:"ml-4",children:(0,s.jsx)("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs font-medium rounded-full",children:"要補充"})})]},e.id))}),(0,s.jsx)("div",{className:"mt-4 text-center",children:(0,s.jsx)(i(),{href:"/admin/products",className:"text-primary-600 hover:text-primary-700 font-medium",children:"商品管理を見る →"})})]})]})]})]})]})}},8681:function(e,t,r){"use strict";r.d(t,{HI:function(){return i},K0:function(){return s},KJ:function(){return seedInitialData},P4:function(){return a},_9:function(){return n}});let initDB=()=>new Promise((e,t)=>{let r=indexedDB.open("SakeShopDB",1);r.onerror=()=>t(r.error),r.onsuccess=()=>e(r.result),r.onupgradeneeded=e=>{let t=e.target.result;if(!t.objectStoreNames.contains("products")){let e=t.createObjectStore("products",{keyPath:"id"});e.createIndex("category","category",{unique:!1}),e.createIndex("name","name",{unique:!1})}if(t.objectStoreNames.contains("cart")||t.createObjectStore("cart",{keyPath:"id"}),!t.objectStoreNames.contains("orders")){let e=t.createObjectStore("orders",{keyPath:"id"});e.createIndex("status","status",{unique:!1}),e.createIndex("date","date",{unique:!1})}if(!t.objectStoreNames.contains("users")){let e=t.createObjectStore("users",{keyPath:"id"});e.createIndex("email","email",{unique:!0})}t.objectStoreNames.contains("diagnosis_history")||t.createObjectStore("diagnosis_history",{keyPath:"id",autoIncrement:!0}),t.objectStoreNames.contains("random_history")||t.createObjectStore("random_history",{keyPath:"id",autoIncrement:!0})}}),s={getAll:async()=>{let e=await initDB();return new Promise((t,r)=>{let s=e.transaction(["products"],"readonly"),a=s.objectStore("products"),n=a.getAll();n.onsuccess=()=>t(n.result),n.onerror=()=>r(n.error)})},add:async e=>{let t=await initDB();return new Promise((r,s)=>{let a=t.transaction(["products"],"readwrite"),n=a.objectStore("products"),i=n.add(e);i.onsuccess=()=>r(),i.onerror=()=>s(i.error)})},update:async e=>{let t=await initDB();return new Promise((r,s)=>{let a=t.transaction(["products"],"readwrite"),n=a.objectStore("products"),i=n.put(e);i.onsuccess=()=>r(),i.onerror=()=>s(i.error)})},delete:async e=>{let t=await initDB();return new Promise((r,s)=>{let a=t.transaction(["products"],"readwrite"),n=a.objectStore("products"),i=n.delete(e);i.onsuccess=()=>r(),i.onerror=()=>s(i.error)})},getByCategory:async e=>{let t=await initDB();return new Promise((r,s)=>{let a=t.transaction(["products"],"readonly"),n=a.objectStore("products"),i=n.index("category"),c=i.getAll(e);c.onsuccess=()=>r(c.result),c.onerror=()=>s(c.error)})}},a={getAll:async()=>{let e=await initDB();return new Promise((t,r)=>{let s=e.transaction(["cart"],"readonly"),a=s.objectStore("cart"),n=a.getAll();n.onsuccess=()=>t(n.result),n.onerror=()=>r(n.error)})},add:async e=>{let t=await initDB();return new Promise((r,s)=>{let a=t.transaction(["cart"],"readwrite"),n=a.objectStore("cart"),i=n.put(e);i.onsuccess=()=>r(),i.onerror=()=>s(i.error)})},remove:async e=>{let t=await initDB();return new Promise((r,s)=>{let a=t.transaction(["cart"],"readwrite"),n=a.objectStore("cart"),i=n.delete(e);i.onsuccess=()=>r(),i.onerror=()=>s(i.error)})},clear:async()=>{let e=await initDB();return new Promise((t,r)=>{let s=e.transaction(["cart"],"readwrite"),a=s.objectStore("cart"),n=a.clear();n.onsuccess=()=>t(),n.onerror=()=>r(n.error)})}},n={getAll:async()=>{let e=await initDB();return new Promise((t,r)=>{let s=e.transaction(["orders"],"readonly"),a=s.objectStore("orders"),n=a.getAll();n.onsuccess=()=>t(n.result),n.onerror=()=>r(n.error)})},add:async e=>{let t=await initDB();return new Promise((r,s)=>{let a=t.transaction(["orders"],"readwrite"),n=a.objectStore("orders"),i=n.add(e);i.onsuccess=()=>r(),i.onerror=()=>s(i.error)})},updateStatus:async(e,t)=>{let r=await initDB();return new Promise((s,a)=>{let n=r.transaction(["orders"],"readwrite"),i=n.objectStore("orders"),c=i.get(e);c.onsuccess=()=>{let e=c.result;if(e){e.status=t;let r=i.put(e);r.onsuccess=()=>s(),r.onerror=()=>a(r.error)}else a(Error("Order not found"))},c.onerror=()=>a(c.error)})}},i={save:async e=>{let t=await initDB();return new Promise((r,s)=>{let a=t.transaction(["diagnosis_history"],"readwrite"),n=a.objectStore("diagnosis_history"),i=n.add(e);i.onsuccess=()=>r(),i.onerror=()=>s(i.error)})},getHistory:async()=>{let e=await initDB();return new Promise((t,r)=>{let s=e.transaction(["diagnosis_history"],"readonly"),a=s.objectStore("diagnosis_history"),n=a.getAll();n.onsuccess=()=>t(n.result),n.onerror=()=>r(n.error)})}},seedInitialData=async()=>{let e=await s.getAll();if(0===e.length)for(let e of[{id:1,name:"純米大吟醸 山田錦",category:"sake",price:3500,description:"山田錦を使用した上品な味わいの純米大吟醸酒",alcoholPercent:15.5,image:"/images/sake1.jpg",tags:["日本酒","純米大吟醸","山田錦"],stock:10,pairing:["刺身","天ぷら","和食"]},{id:2,name:"本格焼酎 黒霧島",category:"shochu",price:1200,description:"さつまいもの甘みが感じられる本格焼酎",alcoholPercent:25,image:"/images/shochu1.jpg",tags:["焼酎","さつまいも","本格"],stock:15,pairing:["焼き鳥","餃子","鍋料理"]},{id:3,name:"シャルドネ 白ワイン",category:"wine",price:2800,description:"フルーティーで爽やかな白ワイン",alcoholPercent:12,image:"/images/wine1.jpg",tags:["ワイン","白ワイン","シャルドネ"],stock:8,pairing:["魚料理","チーズ","サラダ"]},{id:4,name:"クラフトビール IPA",category:"beer",price:450,description:"ホップの苦味が効いたクラフトビール",alcoholPercent:6.5,image:"/images/beer1.jpg",tags:["ビール","クラフト","IPA"],stock:20,pairing:["ピザ","ハンバーガー","スパイシー料理"]},{id:5,name:"チーズ盛り合わせ",category:"snack",price:1800,description:"3種類のチーズの盛り合わせ",alcoholPercent:0,image:"/images/cheese1.jpg",tags:["おつまみ","チーズ","盛り合わせ"],stock:12,pairing:["ワイン","日本酒","ビール"]},{id:6,name:"ナッツミックス",category:"snack",price:680,description:"4種類のナッツをミックスした人気のおつまみ",alcoholPercent:0,image:"/images/nuts1.jpg",tags:["おつまみ","ナッツ","ミックス"],stock:25,pairing:["ビール","ウイスキー","焼酎"]}])await s.add(e)}},622:function(e,t,r){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s=r(2265),a=Symbol.for("react.element"),n=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),i=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function q(e,t,r){var s,o={},l=null,d=null;for(s in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(d=t.ref),t)n.call(t,s)&&!c.hasOwnProperty(s)&&(o[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===o[s]&&(o[s]=t[s]);return{$$typeof:a,type:e,key:l,ref:d,props:o,_owner:i.current}}t.jsx=q,t.jsxs=q},7437:function(e,t,r){"use strict";e.exports=r(622)},1396:function(e,t,r){e.exports=r(8326)}},function(e){e.O(0,[326,971,472,744],function(){return e(e.s=6160)}),_N_E=e.O()}]);